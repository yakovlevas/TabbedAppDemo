<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="TabbedAppDemo.Views.Tab4Page"
             Title="Tab4">

    <ScrollView>
        <VerticalStackLayout Spacing="20" Padding="20">

            <!-- Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº -->
            <Label Text="Tinkoff Invest API" 
                   FontSize="24" 
                   FontAttributes="Bold" 
                   HorizontalOptions="Center"
                   TextColor="{AppThemeBinding Light={StaticResource Black}, Dark={StaticResource White}}"/>

            <!-- ÐŸÐ¾Ð»Ðµ Ð´Ð»Ñ API ÐºÐ»ÑŽÑ‡Ð° -->
            <Frame BackgroundColor="{AppThemeBinding Light={StaticResource LightGray}, Dark={StaticResource DarkGray}}"
                   Padding="15"
                   CornerRadius="10">
                <VerticalStackLayout Spacing="10">
                    <Label Text="API ÐšÐ»ÑŽÑ‡ Tinkoff Invest:" 
                           TextColor="Black"
                           BackgroundColor="LightGray"
                           Padding="10"/>

                    <Entry Text="{Binding ApiKey}" 
                           Placeholder="Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð²Ð°Ñˆ API ÐºÐ»ÑŽÑ‡..."
                           IsPassword="True"
                           BackgroundColor="Transparent"
                           TextColor="{AppThemeBinding Light={StaticResource Black}, Dark={StaticResource White}}"
                           PlaceholderColor="Gray"/>

                    <Button Text="â“ ÐšÐ°Ðº Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ API ÐºÐ»ÑŽÑ‡" 
                            Command="{Binding ShowApiHelpCommand}"
                            BackgroundColor="Gray"
                            TextColor="White"/>
                </VerticalStackLayout>
            </Frame>

            <!-- Ð¡Ñ‚Ð°Ñ‚ÑƒÑ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ -->
            <Frame BackgroundColor="{AppThemeBinding Light={StaticResource LightGray}, Dark={StaticResource DarkGray}}"
                   Padding="15"
                   CornerRadius="10">
                <HorizontalStackLayout Spacing="10" VerticalOptions="Center">
                    <!-- ÐšÑ€ÑƒÐ³ ÑÑ‚Ð°Ñ‚ÑƒÑÐ° -->
                    <Frame WidthRequest="20" 
                           HeightRequest="20" 
                           CornerRadius="10" 
                           Padding="0"
                           BackgroundColor="{Binding ConnectionColor}"/>

                    <!-- Ð¢ÐµÐºÑÑ‚ ÑÑ‚Ð°Ñ‚ÑƒÑÐ° -->
                    <Label Text="{Binding ConnectionStatus}" 
                           TextColor="Black"
                           BackgroundColor="LightGray"
                           Padding="10"
                           VerticalTextAlignment="Center"/>
                </HorizontalStackLayout>
            </Frame>

            <!-- ÐšÐ½Ð¾Ð¿ÐºÐ¸ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸ÐµÐ¼ -->
            <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                <Button Text="ðŸ”— ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒÑÑ" 
                        Command="{Binding ConnectToTinkoffCommand}"
                        IsEnabled="{Binding CanConnect}"
                        BackgroundColor="{StaticResource Primary}"
                        TextColor="White"
                        Grid.Column="0"/>

                <Button Text="ðŸ—‘ï¸ ÐžÑ‚ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒÑÑ" 
                        Command="{Binding ClearConnectionCommand}"
                        IsEnabled="{Binding IsConnected}"
                        BackgroundColor="{StaticResource Error}"
                        TextColor="White"
                        Grid.Column="1"/>
            </Grid>

            <!-- ÐšÐ½Ð¾Ð¿ÐºÐ¸ Ð´Ð»Ñ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð½Ð¾Ð³Ð¾ Ñ‚Ð¾ÐºÐµÐ½Ð° -->
            <Grid ColumnDefinitions="*,*" ColumnSpacing="10" 
                  IsVisible="{Binding HasSavedToken}">
                <Button Text="ðŸ“± Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð½Ñ‹Ð¹" 
                        Command="{Binding UseSavedTokenCommand}"
                        BackgroundColor="{StaticResource Success}"
                        TextColor="White"
                        Grid.Column="0"/>

                <Button Text="ðŸ—‘ï¸ Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð½Ñ‹Ð¹" 
                        Command="{Binding ClearSavedTokenCommand}"
                        BackgroundColor="{StaticResource Warning}"
                        TextColor="Black"
                        Grid.Column="1"/>
            </Grid>

            <!-- Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ ÑÑ‡ÐµÑ‚Ðµ -->
            <Frame BackgroundColor="{AppThemeBinding Light={StaticResource LightGray}, Dark={StaticResource DarkGray}}"
                   Padding="15"
                   CornerRadius="10">
                <VerticalStackLayout Spacing="10">
                    <Label Text="Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ Ð±Ñ€Ð¾ÐºÐµÑ€ÑÐºÐ¾Ð¼ ÑÑ‡ÐµÑ‚Ðµ:" 
                           FontAttributes="Bold"
                           TextColor="{AppThemeBinding Light={StaticResource Black}, Dark={StaticResource White}}"/>

                    <Label Text="{Binding AccountInfoText}" 
                            TextColor="Black" 
                            BackgroundColor="LightGray"
                            Padding="10"/>
                    <Button Text="ðŸ”„ ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ" 
                            Command="{Binding GetAccountInfoCommand}"
                            IsEnabled="{Binding CanGetInfo}"
                            BackgroundColor="{StaticResource Info}"
                            TextColor="White"
                            HorizontalOptions="End"/>
                </VerticalStackLayout>
            </Frame>

            <!-- Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ Ð¿Ð¾Ñ€Ñ‚Ñ„ÐµÐ»Ðµ -->
            <Frame BackgroundColor="{AppThemeBinding Light={StaticResource LightGray}, Dark={StaticResource DarkGray}}"
                   Padding="15"
                   CornerRadius="10">
                <VerticalStackLayout Spacing="10">
                    <Label Text="Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ Ð¿Ð¾Ñ€Ñ‚Ñ„ÐµÐ»Ðµ:" 
                           FontAttributes="Bold"
                           TextColor="{AppThemeBinding Light={StaticResource Black}, Dark={StaticResource White}}"/>

                    <Label Text="{Binding PortfolioInfoText}" 
                           TextColor="Black"
                           BackgroundColor="LightGray"
                           Padding="10"/>
                    <Button Text="ðŸ“Š Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð¿Ð¾Ñ€Ñ‚Ñ„ÐµÐ»ÑŒ" 
                            Command="{Binding GetPortfolioInfoCommand}"
                            IsEnabled="{Binding CanGetInfo}"
                            BackgroundColor="{StaticResource Info}"
                            TextColor="White"
                            HorizontalOptions="End"/>
                </VerticalStackLayout>
            </Frame>

            <!-- Ð˜Ð½Ð´Ð¸ÐºÐ°Ñ‚Ð¾Ñ€ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ -->
            <ActivityIndicator IsRunning="{Binding IsLoading}" 
                               IsVisible="{Binding IsLoading}"
                               Color="{StaticResource Primary}"
                               HorizontalOptions="Center"/>

            <!-- ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð½Ð¾Ð³Ð¾ Ñ‚Ð¾ÐºÐµÐ½Ð° -->
            <ActivityIndicator IsRunning="{Binding IsCheckingSavedToken}" 
                               IsVisible="{Binding IsCheckingSavedToken}"
                               Color="{StaticResource Primary}"
                               HorizontalOptions="Center"/>

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>